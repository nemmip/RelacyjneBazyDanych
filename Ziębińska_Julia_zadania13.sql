------------------------------------------------------------------------------------------
---------- Procedura
------------------------------------------------------------------------------------------
---------- Stwórz procedurę pozwalającą na zastosowanie zniżki na cenach produktów
------------------------------------------------------------------------------------------
use Northwind
CREATE PROC Procedura @DISCOUNT float
AS
SELECT ProductName, (UnitPrice * (1 - @DISCOUNT)) as UnitPrice FROM Products
exec Procedura 0.4
------------------------------------------------------------------------------------------
---------- Funkcja
------------------------------------------------------------------------------------------
---------- Utwórz funkcję pozwalającą na obliczenie maksymalnej zniżki dla produktu.
------------------------------------------------------------------------------------------


------------------------------------------------------------------------------------------
---------- Stwórz bazę danych "Operatory"
------------------------------------------------------------------------------------------
CREATE DATABASE Operatory



------------------------------------------------------------------------------------------
---------- Stwórz tabele "t1" i "t2" z dwoma kolumnami:
---------- "ID1" / "ID2" - liczba całkowita
---------- "K1" / "K2" - typ znakowy o stałej długości 1.
------------------------------------------------------------------------------------------
CREATE TABLE t1
(
	ID1 INT,
	K1 CHAR(1)
)

CREATE TABLE t2
(
	ID2 INT,
	K2 CHAR(1)
)



------------------------------------------------------------------------------------------
---------- Wypełnij tabele przykładowymi danymi.
---------- t1 - (1,'q'), (2,'w'), (3,'e'), (4,'r')
---------- t2 - (3,'m'), (2,'n'), (1,'b')
------------------------------------------------------------------------------------------
INSERT INTO t1 VALUES (1,'q')
INSERT INTO t1 VALUES (2,'w')
INSERT INTO t1 VALUES (3,'e')
INSERT INTO t1 VALUES (4,'r')

INSERT INTO t2 VALUES (3,'m')
INSERT INTO t2 VALUES (2,'n')
INSERT INTO t2 VALUES (1,'b')

SELECT * FROM t1
SELECT * FROM t2



------------------------------------------------------------------------------------------
---------- =
------------------------------------------------------------------------------------------
---------- error
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 =
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- = (SELECT TOP ...)
------------------------------------------------------------------------------------------
---------- 1 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 =
			(SELECT TOP 1 ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Jeżeli wartość ID1 = ID2
------------------------------------------------------------------------------------------
---------- = ANY
------------------------------------------------------------------------------------------
---------- 3 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 = ANY
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Jeżeli wartość ID1 = ID2
------------------------------------------------------------------------------------------
---------- = SOME
------------------------------------------------------------------------------------------
---------- 3 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 = SOME
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Jeżeli wartość ID1 < ID2
------------------------------------------------------------------------------------------
---------- < ANY
------------------------------------------------------------------------------------------
---------- 2 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 < ANY
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Jeżeli wartość ID1 > ID2
------------------------------------------------------------------------------------------
---------- > ANY
------------------------------------------------------------------------------------------
---------- 3 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 > ANY
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Jeżeli wartość ID1 <> ID2
------------------------------------------------------------------------------------------
---------- <> ANY
------------------------------------------------------------------------------------------
---------- 4 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 <> ANY
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Jeżeli wartość ID1 ma odpowiednik w ID2
------------------------------------------------------------------------------------------
---------- IN
------------------------------------------------------------------------------------------
---------- 3 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 IN
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Jeżeli wartość ID1 nie ma odpowiednika w ID2
------------------------------------------------------------------------------------------
---------- NOT IN
------------------------------------------------------------------------------------------
---------- 1 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 NOT IN
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Wyświetl jeżeli istnieje
------------------------------------------------------------------------------------------
---------- EXISTS
------------------------------------------------------------------------------------------
---------- 4 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE EXISTS
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Wyświetl jeżeli istnieje
------------------------------------------------------------------------------------------
---------- EXISTS
------------------------------------------------------------------------------------------
---------- 0 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE EXISTS
			(SELECT ID2 FROM t2 WHERE ID2 = 10)



------------------------------------------------------------------------------------------
---------- Wyświetl jeżeli istnieje
------------------------------------------------------------------------------------------
---------- EXISTS
------------------------------------------------------------------------------------------
---------- 4 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE EXISTS
			(SELECT ID2 FROM t2 WHERE ID2 = 1)



------------------------------------------------------------------------------------------
---------- Wyświetl jeżeli nie istnieje
------------------------------------------------------------------------------------------
---------- NOT EXISTS
------------------------------------------------------------------------------------------
---------- 0 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE NOT EXISTS
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Wyświetl jeżeli nie istnieje
------------------------------------------------------------------------------------------
---------- NOT EXISTS
------------------------------------------------------------------------------------------
---------- 4 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE NOT EXISTS
			(SELECT ID2 FROM t2 WHERE ID2 = 10)

SELECT * FROM t1
WHERE NOT EXISTS
			(SELECT ID2 FROM t2 WHERE ID2 = 1)



------------------------------------------------------------------------------------------
---------- Wyświetl jeżeli ID1 = wszystkim ID2
------------------------------------------------------------------------------------------
---------- ALL
------------------------------------------------------------------------------------------
---------- 0 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 = ALL
			(SELECT ID2 FROM t2)



------------------------------------------------------------------------------------------
---------- Wyświetl jeżeli ID1 = wszystkim ID2
------------------------------------------------------------------------------------------
---------- ALL
------------------------------------------------------------------------------------------
---------- 4 rows
------------------------------------------------------------------------------------------
SELECT * FROM t1
WHERE ID1 = ALL
			(SELECT ID2 FROM t2 WHERE ID2 = 10)



------------------------------------------------------------------------------------------
---------- Wyświetl jeżeli ID1 = wszystkim ID2
------------------------------------------------------------------------------------------
---------- ALL
------------------------------------------------------------------------------------------
---------- 1 rows
------------------------------------------------------------------------------------------
SELECT* FROM t1
WHERE ID1 = ALL
			(SELECT ID2 FROM t2 WHERE ID2 = 1)